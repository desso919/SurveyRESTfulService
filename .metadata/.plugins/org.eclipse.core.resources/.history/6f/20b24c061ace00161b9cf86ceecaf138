package com.tu.survey.client;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.ws.rs.core.MediaType;

import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.sun.jersey.api.client.*;
import com.tu.survey.aplication.Question;
import com.tu.survey.aplication.Survey;

public class SurveyClient {

	public static void main(String[] args) throws JsonParseException, JsonMappingException, IOException {
		ObjectMapper mapper = new ObjectMapper();
//		Client client = Client.create();
//		
//		WebResource resource = client.resource("http://localhost:8080/SurveyRESTfulService/survey/questions");
//
//		// Get response as String
//		String responce = resource.accept(MediaType.APPLICATION_JSON).get(String.class);
//
//		// JSON from String to Object
//		Survey survey = mapper.readValue(responce, Survey.class);
//
//		System.out.println(survey.getName());
//		List<Question> questions = survey.getQuestions();
//		
//		for(Question question: questions) {
//			System.out.println("\n" + question);
//			List<String> answers = question.getAnswers();
//			for(String answer:answers) {
//				System.out.println(answer);
//			}
//		
//		}
		
//		Survey servey = new Survey(" Best city in Bulgaria");
//		servey.addQuestion(new Question("Question 1" , true, "option 1", "option 2"));
//		servey.addQuestion(new Question("Question 2" , true, "option 1", "option 2"));
//		
//		Survey servey1 = new Survey(" Best city in Bulgaria2");
//		servey1.addQuestion(new Question("Question 1" , true, "option 1", "option 2"));
//		servey1.addQuestion(new Question("Question 2" , true, "option 1", "option 2"));
//
//		List<Survey> surveys = new ArrayList<Survey>();
//		
//		surveys.add(servey);
//		surveys.add(servey1);
//		mapper.writeValue(new File("D:\\surveys.json"), surveys);
		
		// Convert JSON string from file to Object
		List<Survey> surveys = mapper.readValue(new File("D:\\surveys.json"), List<Survey>.class);


		for (Survey survey : surveys) {
			System.out.println(survey.getName());
		}
		
	}
}
