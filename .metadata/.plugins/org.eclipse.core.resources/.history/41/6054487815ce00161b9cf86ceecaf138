package com.tu.survey.client;

import java.io.IOException;
import java.util.List;
import javax.ws.rs.core.MediaType;

import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.sun.jersey.api.client.*;
import com.tu.survey.aplication.Question;
import com.tu.survey.aplication.Survey;

public class SurveyClient {

	public static void main(String[] args) throws JsonParseException, JsonMappingException, IOException {
		ObjectMapper mapper = new ObjectMapper();
		Client client = Client.create();
		
		WebResource resource = client.resource("http://localhost:8080/SurveyRESTfulService/survey/questions");

		// Get response as String
		String responce = resource.accept(MediaType.APPLICATION_JSON).get(String.class);

		// JSON from String to Object
		Survey survey = mapper.readValue(responce, Survey.class);

		System.out.println(survey.getName());
		List<Question> questions = survey.getQuestions();
		
		for(Question question: questions) {
			System.out.println();
			System.out.println(question);
			List<String> answers = question.getAnswers();
			for(String answer:answers) {
				System.out.println(answer);
			}
		
		}
		
	}
}
